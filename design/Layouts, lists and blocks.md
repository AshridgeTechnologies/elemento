Layouts, lists and blocks
=========================

20 Mar 2024

Aims
----

- Simple, unified, versatile concept for elements that may contain others
- Intuitive and easy to use approach for developers
- Allow for future unforeseen arrangements

Needs
-----

- Standard vertical and horizontal layouts of a fixed set of elements
- Standard vertical lists from a variable set of elements
- Free-form layouts of a fixed set of elements
- Free-form layouts of a variable set of elements
- Positions of elements in a set generated from input data or the index
- Blocks that can be styled and may or may not contain other elements

Forces
------

- Lists are conceptually different because they have a variable set of items, are selectable, ordered, etc
- Layouts have a set of elements known at design time
- Standard and free-form layouts have some things in common - they both contain other elements
- Standard and free-form layouts have different intentions
- Standard and free-form layouts have different implementations
- Blocks could just be empty (free-form) layouts
- Free-form lists also have some things in common with standard lists, but also different intentions and implementations 
- Formal lists in MUI use lots of wrappers etc which could interfere with free-form positioning
- For absolute positioning, need both a relative container and an absolute position contained element

Possibilities
-------------

- Make Layout a Block, may or may not contain other elements
- Block can be vertical, horizontal, horizontal-wrap or free-form
- Free-form uses absolute positioning - need to set position on each element
- Lists can have the same options
- Keep Layout separate from Block to avoid confusion - but confusing anyway if have two similar elements
- Separate List Block element to avoid confusion
- Blocks can have variable items instead of fixed children - then repeat all the children for each item
- Blocks can have variable items as well as fixed children - but would not know which is which
- Wrap or clone each child element to set position absolute
- Leave it to dev to set position on each element
- Item Set element repeats its contents for each of a set of data items
- Put an Item Set inside a List, a Block, or future elements, or just directly in a Page
- Lists can have fixed elements as well as data-driven
- Avoid generating list item components?


Focus: Item Set usable with any container
-----------------------------------------

- Could produce a fragment with a list of elements
- Would probably still need a generated component to map the data onto
- How to deal with selected item(s)?
- Item Set probably knows the selected items and handles the select action
- Item Set knows the data
- Item selection needs to be handled by individual item and then the Item set
- Container may want to know if an item is selected to display it differently eg MUI List -> ListItem
- But the item generated by the Item Set could display differently and may want to in a custom way eg by a tick
- Item Set items will need a wrapper around the parts of each item
- Item Set wrapper may need to be styled - could put a Block/Layout inside the item
- Item Set could have Item styles that are applied to each item to save another wrapper inside the wrapper

Item Set selections
-------------------

- Multiple selections need to be possible
- Need to work with plain data (like strings) or objects with or without an id
- Change Selectable to be a choice of Not selectable, Single, Multiple
- Keep Selected Item state property - always the most recently selected item
- Add Selected Items state property - all selected items, always an array, even if single select, in the order they were selected
- Add Selected Item Ids state property - as often want id, and in some cases have items the same (eg letter puzzle)
- Change Selected Item input property to be Selected Items, with single, multiple or array arguments - just flatten
- Selected Item input arguments matched to item first, then item id, then to index
- Set works the same way
- SelectAction needs to be able to block a selection, or change it, and/or do other things
- SelectAction needs to get the new selected item, the existing selected items
- Select Action can return false to block the selection, an array to change it or undefined to just select normally
- But also want SelectAction to do things after the selection has changed
- May be clearer to have a modifySelect and AfterSelectAction
- Select function on state acts like a click selection, calls SelectAction
- Set just sets and does not call SelectAction

Item Set Spike
--------------

- ✅ Create Item Set based on List - but no styling/show
- ✅ Generate ItemSet component
- ✅ Has same selectable selectedItem as List
- ✅ $selected is sent through to the item component
- ✅ Try on its own in page
- List becomes a layout only component
- ✅ No list state class, scrolling can be React state? No - because want to keep if switch page
- ✅ Need to upgrade MUI to get wrapped Stack working
- ✅ BUT this stops tutorials working because of the slotprops backdrop issue

Decision
--------

- Item Set Spike successful
